<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3276px" preserveAspectRatio="none" style="width:1162px;height:3276px;" version="1.1" viewBox="0 0 1162 3276" width="1162px" zoomAndPan="magnify"><defs><filter height="300%" id="fanszb5v07vcj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="3261.9842" style="stroke: #A80036; stroke-width: 1.0;" width="126" x="999.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="1002.5" y="17.897">Internal Interface</text><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="271.63" style="stroke: #000000; stroke-width: 2.0;" width="937.5" x="13" y="246.892"/><rect fill="#FFFFFF" height="80.3939" style="stroke: none; stroke-width: 1.0;" width="937.5" x="13" y="438.1281"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="271.63" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="673.3461"/><rect fill="#FFFFFF" height="80.3939" style="stroke: none; stroke-width: 1.0;" width="990.5" x="13" y="864.5822"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="290.336" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="1348.7423"/><rect fill="#FFFFFF" height="80.3939" style="stroke: none; stroke-width: 1.0;" width="990.5" x="13" y="1558.6844"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="290.336" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="1806.9024"/><rect fill="#FFFFFF" height="80.3939" style="stroke: none; stroke-width: 1.0;" width="990.5" x="13" y="2016.8445"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="436.4179" style="stroke: #000000; stroke-width: 2.0;" width="865.5" x="138" y="2233.3565"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="227.1999" style="stroke: #000000; stroke-width: 2.0;" width="692.5" x="148" y="2386.8865"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="100.0999" style="stroke: #000000; stroke-width: 2.0;" width="540" x="158" y="2458.2986"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="540" x="158" y="2509.7106"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="692.5" x="148" y="2565.3985"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="865.5" x="138" y="2621.0864"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="354.0239" style="stroke: #000000; stroke-width: 2.0;" width="641.5" x="499" y="2805.8924"/><rect fill="#FFFFFF" filter="url(#fanszb5v07vcj)" height="100.0999" style="stroke: #000000; stroke-width: 2.0;" width="621.5" x="509" y="3004.1285"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="621.5" x="509" y="3055.5405"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="641.5" x="499" y="3111.2284"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="41" x2="41" y1="89.0679" y2="3176.9163"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="236" x2="236" y1="89.0679" y2="3176.9163"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="603" x2="603" y1="89.0679" y2="3176.9163"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="888.5" x2="888.5" y1="89.0679" y2="3176.9163"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="971.5" x2="971.5" y1="89.0679" y2="3176.9163"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1062.5" x2="1062.5" y1="89.0679" y2="3176.9163"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="23" y="84.9659">User</text><ellipse cx="41.5" cy="13" fill="#FEFECE" filter="url(#fanszb5v07vcj)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M41.5,21 L41.5,48 M28.5,29 L54.5,29 M41.5,48 L28.5,63 M41.5,48 L54.5,63 " fill="none" filter="url(#fanszb5v07vcj)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="23" y="3190.8822">User</text><ellipse cx="41.5" cy="3204.9842" fill="#FEFECE" filter="url(#fanszb5v07vcj)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M41.5,3212.9842 L41.5,3239.9842 M28.5,3220.9842 L54.5,3220.9842 M41.5,3239.9842 L28.5,3254.9842 M41.5,3239.9842 L54.5,3254.9842 " fill="none" filter="url(#fanszb5v07vcj)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="168" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="175" y="72.9659">Client Application</text><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="168" y="3175.9163"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="175" y="3197.8822">Client Application</text><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="519" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="526" y="72.9659">Authentication Service</text><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="519" y="3175.9163"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="526" y="3197.8822">Authentication Service</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="836.5" y="84.9659">User Database</text><path d="M870.5,34 C870.5,24 888.5,24 888.5,24 C888.5,24 906.5,24 906.5,34 L906.5,60 C906.5,70 888.5,70 888.5,70 C888.5,70 870.5,70 870.5,60 L870.5,34 " fill="#FEFECE" filter="url(#fanszb5v07vcj)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M870.5,34 C870.5,44 888.5,44 888.5,44 C888.5,44 906.5,44 906.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="836.5" y="3190.8822">User Database</text><path d="M870.5,3204.9842 C870.5,3194.9842 888.5,3194.9842 888.5,3194.9842 C888.5,3194.9842 906.5,3194.9842 906.5,3204.9842 L906.5,3230.9842 C906.5,3240.9842 888.5,3240.9842 888.5,3240.9842 C888.5,3240.9842 870.5,3240.9842 870.5,3230.9842 L870.5,3204.9842 " fill="#FEFECE" filter="url(#fanszb5v07vcj)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M870.5,3204.9842 C870.5,3214.9842 888.5,3214.9842 888.5,3214.9842 C888.5,3214.9842 906.5,3214.9842 906.5,3204.9842 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="950.5" y="84.9659">Redis</text><path d="M954,34 C954,24 972,24 972,24 C972,24 990,24 990,34 L990,60 C990,70 972,70 972,70 C972,70 954,70 954,60 L954,34 " fill="#FEFECE" filter="url(#fanszb5v07vcj)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M954,34 C954,44 972,44 972,44 C972,44 990,44 990,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="950.5" y="3190.8822">Redis</text><path d="M954,3204.9842 C954,3194.9842 972,3194.9842 972,3194.9842 C972,3194.9842 990,3194.9842 990,3204.9842 L990,3230.9842 C990,3240.9842 972,3240.9842 972,3240.9842 C972,3240.9842 954,3240.9842 954,3230.9842 L954,3204.9842 " fill="#FEFECE" filter="url(#fanszb5v07vcj)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M954,3204.9842 C954,3214.9842 972,3214.9842 972,3214.9842 C972,3214.9842 990,3214.9842 990,3204.9842 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="1004.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1011.5" y="72.9659">Other Services</text><rect fill="#FEFECE" filter="url(#fanszb5v07vcj)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="1004.5" y="3175.9163"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1011.5" y="3197.8822">Other Services</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="120.9209"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="120.9209" y2="120.9209"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="123.9209" y2="123.9209"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="132" x="510.75" y="109.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="516.75" y="126.9649">User Registration</text><polygon fill="#A80036" points="224.5,164.4799,234.5,168.4799,224.5,172.4799,228.5,168.4799" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="230.5" y1="168.4799" y2="168.4799"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="48.5" y="162.6709">Initiates Registration</text><polygon fill="#A80036" points="591.5,196.186,601.5,200.186,591.5,204.186,595.5,200.186" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="200.186" y2="200.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="343" x="243.5" y="194.377">POST /auth/register (user: {name, email, password, roles})</text><polygon fill="#A80036" points="876.5,227.892,886.5,231.892,876.5,235.892,880.5,231.892" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="231.892" y2="231.892"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="610.5" y="226.083">Checks if user with email exists</text><path d="M13,246.892 L76,246.892 L76,255.892 L66,265.892 L13,265.892 L13,246.892 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="271.63" style="stroke: #000000; stroke-width: 2.0;" width="937.5" x="13" y="246.892"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="261.789">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="91" y="260.6509">[User does not exist]</text><polygon fill="#A80036" points="876.5,286.304,886.5,290.304,876.5,294.304,880.5,290.304" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="290.304" y2="290.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="610.5" y="284.495">Creates new user</text><polygon fill="#A80036" points="614.5,318.01,604.5,322.01,614.5,326.01,610.5,322.01" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="887.5" y1="322.01" y2="322.01"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="620.5" y="316.201">User created (user ID, roles)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="353.716" y2="353.716"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="353.716" y2="366.716"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="366.716" y2="366.716"/><polygon fill="#A80036" points="614.5,362.716,604.5,366.716,614.5,370.716,610.5,366.716" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="610.5" y="347.907">Generates JWT (including roles, user ID)</text><polygon fill="#A80036" points="247.5,394.4221,237.5,398.4221,247.5,402.4221,243.5,398.4221" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="398.4221" y2="398.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="253.5" y="392.6131">Registration Successful (JWT)</text><polygon fill="#A80036" points="224.5,426.1281,234.5,430.1281,224.5,434.1281,228.5,430.1281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="430.1281" y2="430.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="48.5" y="424.3191">Registration Successful (JWT)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="950.5" y1="439.1281" y2="439.1281"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="18" y="450.887">[User exists]</text><polygon fill="#A80036" points="247.5,474.816,237.5,478.816,247.5,482.816,243.5,478.816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="478.816" y2="478.816"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="253.5" y="473.007">Registration Failed (Email already exists)</text><polygon fill="#A80036" points="224.5,506.522,234.5,510.522,224.5,514.522,228.5,510.522" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="510.522" y2="510.522"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="48.5" y="504.713">Registration Failed</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="547.375"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="547.375" y2="547.375"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="550.375" y2="550.375"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="86" x="533.75" y="535.522"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="539.75" y="553.419">User Login</text><polygon fill="#A80036" points="224.5,590.934,234.5,594.934,224.5,598.934,228.5,594.934" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="230.5" y1="594.934" y2="594.934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="48.5" y="589.125">Initiates Login</text><polygon fill="#A80036" points="591.5,622.6401,601.5,626.6401,591.5,630.6401,595.5,626.6401" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="626.6401" y2="626.6401"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="243.5" y="620.831">POST /auth/login (email, password)</text><polygon fill="#A80036" points="876.5,654.3461,886.5,658.3461,876.5,662.3461,880.5,658.3461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="658.3461" y2="658.3461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="610.5" y="652.5371">Authenticates user</text><path d="M13,673.3461 L76,673.3461 L76,682.3461 L66,692.3461 L13,692.3461 L13,673.3461 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="271.63" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="673.3461"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="688.2431">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="91" y="687.105">[Authentication successful]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="716.7581" y2="716.7581"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="716.7581" y2="729.7581"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="729.7581" y2="729.7581"/><polygon fill="#A80036" points="614.5,725.7581,604.5,729.7581,614.5,733.7581,610.5,729.7581" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="610.5" y="710.9491">Generates JWT (including roles, user ID)</text><polygon fill="#A80036" points="960,757.4641,970,761.4641,960,765.4641,964,761.4641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="761.4641" y2="761.4641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="610.5" y="755.6551">SET JWT (JWT, user ID, TTL)</text><polygon fill="#A80036" points="614.5,789.1701,604.5,793.1701,614.5,797.1701,610.5,793.1701" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="793.1701" y2="793.1701"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="620.5" y="787.3611">OK</text><polygon fill="#A80036" points="247.5,820.8762,237.5,824.8762,247.5,828.8762,243.5,824.8762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="824.8762" y2="824.8762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="253.5" y="819.0671">JWT</text><polygon fill="#A80036" points="224.5,852.5822,234.5,856.5822,224.5,860.5822,228.5,856.5822" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="856.5822" y2="856.5822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="48.5" y="850.7732">Login Successful (JWT)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1003.5" y1="865.5822" y2="865.5822"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="126" x="18" y="877.3411">[Authentication failed]</text><polygon fill="#A80036" points="247.5,901.2701,237.5,905.2701,247.5,909.2701,243.5,905.2701" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="905.2701" y2="905.2701"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="253.5" y="899.4611">Login Failed (Invalid credentials)</text><polygon fill="#A80036" points="224.5,932.9761,234.5,936.9761,224.5,940.9761,228.5,936.9761" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="936.9761" y2="936.9761"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="48.5" y="931.1671">Login Failed</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="973.8291"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="973.8291" y2="973.8291"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="976.8291" y2="976.8291"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="96" x="528.75" y="961.9761"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="534.75" y="979.8731">User Logout</text><polygon fill="#A80036" points="224.5,1017.3881,234.5,1021.3881,224.5,1025.3881,228.5,1021.3881" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="230.5" y1="1021.3881" y2="1021.3881"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="48.5" y="1015.5791">Initiates Logout</text><polygon fill="#A80036" points="591.5,1049.0941,601.5,1053.0941,591.5,1057.0941,595.5,1053.0941" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="1053.0941" y2="1053.0941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="243.5" y="1047.2851">POST /auth/logout (JWT)</text><polygon fill="#A80036" points="960,1080.8002,970,1084.8002,960,1088.8002,964,1084.8002" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="1084.8002" y2="1084.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="610.5" y="1078.9912">DEL JWT</text><polygon fill="#A80036" points="614.5,1112.5062,604.5,1116.5062,614.5,1120.5062,610.5,1116.5062" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="1116.5062" y2="1116.5062"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="620.5" y="1110.6972">(ACK)</text><polygon fill="#A80036" points="247.5,1144.2122,237.5,1148.2122,247.5,1152.2122,243.5,1148.2122" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="1148.2122" y2="1148.2122"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="253.5" y="1142.4032">Logout Successful</text><polygon fill="#A80036" points="224.5,1175.9182,234.5,1179.9182,224.5,1183.9182,228.5,1179.9182" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="1179.9182" y2="1179.9182"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="48.5" y="1174.1092">Logout Successful</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="1209.7712"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="1209.7712" y2="1209.7712"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="1212.7712" y2="1212.7712"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="119" x="517.25" y="1197.9182"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="523.25" y="1215.8152">Get User Profile</text><polygon fill="#A80036" points="224.5,1253.3302,234.5,1257.3302,224.5,1261.3302,228.5,1257.3302" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="230.5" y1="1257.3302" y2="1257.3302"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="48.5" y="1251.5212">Requests User Profile</text><polygon fill="#A80036" points="591.5,1285.0363,601.5,1289.0363,591.5,1293.0363,595.5,1289.0363" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="1289.0363" y2="1289.0363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="243.5" y="1283.2273">GET /users/me (with JWT)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="1320.7423" y2="1320.7423"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="1320.7423" y2="1333.7423"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="1333.7423" y2="1333.7423"/><polygon fill="#A80036" points="614.5,1329.7423,604.5,1333.7423,614.5,1337.7423,610.5,1333.7423" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="610.5" y="1314.9333">Validates JWT (internally)</text><path d="M13,1348.7423 L76,1348.7423 L76,1357.7423 L66,1367.7423 L13,1367.7423 L13,1348.7423 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="290.336" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="1348.7423"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="1363.6393">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="91" y="1362.5012">[JWT is valid]</text><polygon fill="#A80036" points="960,1388.1543,970,1392.1543,960,1396.1543,964,1392.1543" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="1392.1543" y2="1392.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="610.5" y="1386.3453">GET user ID by JWT</text><polygon fill="#A80036" points="614.5,1419.8603,604.5,1423.8603,614.5,1427.8603,610.5,1423.8603" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="1423.8603" y2="1423.8603"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="620.5" y="1418.0513">user ID</text><polygon fill="#A80036" points="876.5,1451.5663,886.5,1455.5663,876.5,1459.5663,880.5,1455.5663" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="1455.5663" y2="1455.5663"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="610.5" y="1449.7573">Get user info by ID (user ID from Redis)</text><polygon fill="#A80036" points="614.5,1483.2724,604.5,1487.2724,614.5,1491.2724,610.5,1487.2724" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="887.5" y1="1487.2724" y2="1487.2724"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="620.5" y="1481.4634">User profile data</text><polygon fill="#A80036" points="247.5,1514.9784,237.5,1518.9784,247.5,1522.9784,243.5,1518.9784" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="1518.9784" y2="1518.9784"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="253.5" y="1513.1694">User profile data</text><polygon fill="#A80036" points="224.5,1546.6844,234.5,1550.6844,224.5,1554.6844,228.5,1550.6844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="1550.6844" y2="1550.6844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="48.5" y="1544.8754">User profile displayed</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1003.5" y1="1559.6844" y2="1559.6844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="18" y="1571.4433">[JWT is invalid or expired]</text><polygon fill="#A80036" points="247.5,1595.3723,237.5,1599.3723,247.5,1603.3723,243.5,1599.3723" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="1599.3723" y2="1599.3723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="253.5" y="1593.5633">Unauthorized</text><polygon fill="#A80036" points="224.5,1627.0783,234.5,1631.0783,224.5,1635.0783,228.5,1631.0783" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="1631.0783" y2="1631.0783"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="48.5" y="1625.2693">Unauthorized</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="1667.9313"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="1667.9313" y2="1667.9313"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="1670.9313" y2="1670.9313"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="144" x="504.75" y="1656.0783"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="510.75" y="1673.9753">Update User Profile</text><polygon fill="#A80036" points="224.5,1711.4903,234.5,1715.4903,224.5,1719.4903,228.5,1715.4903" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="230.5" y1="1715.4903" y2="1715.4903"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="48.5" y="1709.6813">Initiates Profile Update</text><polygon fill="#A80036" points="591.5,1743.1964,601.5,1747.1964,591.5,1751.1964,595.5,1747.1964" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="1747.1964" y2="1747.1964"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="243.5" y="1741.3874">PUT /users/me (with JWT, updated user data)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="1778.9024" y2="1778.9024"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="1778.9024" y2="1791.9024"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="1791.9024" y2="1791.9024"/><polygon fill="#A80036" points="614.5,1787.9024,604.5,1791.9024,614.5,1795.9024,610.5,1791.9024" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="610.5" y="1773.0934">Validates JWT (internally)</text><path d="M13,1806.9024 L76,1806.9024 L76,1815.9024 L66,1825.9024 L13,1825.9024 L13,1806.9024 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="290.336" style="stroke: #000000; stroke-width: 2.0;" width="990.5" x="13" y="1806.9024"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="1821.7994">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="91" y="1820.6613">[JWT is valid]</text><polygon fill="#A80036" points="960,1846.3144,970,1850.3144,960,1854.3144,964,1850.3144" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="1850.3144" y2="1850.3144"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="610.5" y="1844.5054">GET user ID by JWT</text><polygon fill="#A80036" points="614.5,1878.0204,604.5,1882.0204,614.5,1886.0204,610.5,1882.0204" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="1882.0204" y2="1882.0204"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="620.5" y="1876.2114">user ID</text><polygon fill="#A80036" points="876.5,1909.7264,886.5,1913.7264,876.5,1917.7264,880.5,1913.7264" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="1913.7264" y2="1913.7264"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="610.5" y="1907.9174">Updates user profile (user ID, updated data)</text><polygon fill="#A80036" points="614.5,1941.4325,604.5,1945.4325,614.5,1949.4325,610.5,1945.4325" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="887.5" y1="1945.4325" y2="1945.4325"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="620.5" y="1939.6235">Update successful</text><polygon fill="#A80036" points="247.5,1973.1385,237.5,1977.1385,247.5,1981.1385,243.5,1977.1385" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="1977.1385" y2="1977.1385"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="253.5" y="1971.3295">Update successful</text><polygon fill="#A80036" points="224.5,2004.8445,234.5,2008.8445,224.5,2012.8445,228.5,2008.8445" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="2008.8445" y2="2008.8445"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="48.5" y="2003.0355">Profile updated successfully</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1003.5" y1="2017.8445" y2="2017.8445"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="18" y="2029.6034">[JWT is invalid or expired]</text><polygon fill="#A80036" points="247.5,2053.5324,237.5,2057.5324,247.5,2061.5324,243.5,2057.5324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="2057.5324" y2="2057.5324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="253.5" y="2051.7234">Unauthorized</text><polygon fill="#A80036" points="224.5,2085.2384,234.5,2089.2384,224.5,2093.2384,228.5,2089.2384" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="41.5" x2="230.5" y1="2089.2384" y2="2089.2384"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="48.5" y="2083.4294">Unauthorized</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="2126.0914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="2126.0914" y2="2126.0914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="2129.0914" y2="2129.0914"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="161" x="496.25" y="2114.2384"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="502.25" y="2132.1354">Verify Token Endpoint</text><polygon fill="#A80036" points="591.5,2169.6504,601.5,2173.6504,591.5,2177.6504,595.5,2173.6504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="597.5" y1="2173.6504" y2="2173.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="243.5" y="2167.8414">POST /auth/verify-token (JWT, optional authority)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="2205.3565" y2="2205.3565"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="2205.3565" y2="2218.3565"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="2218.3565" y2="2218.3565"/><polygon fill="#A80036" points="614.5,2214.3565,604.5,2218.3565,614.5,2222.3565,610.5,2218.3565" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="610.5" y="2199.5475">Validates JWT (internally)</text><path d="M138,2233.3565 L201,2233.3565 L201,2242.3565 L191,2252.3565 L138,2252.3565 L138,2233.3565 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="436.4179" style="stroke: #000000; stroke-width: 2.0;" width="865.5" x="138" y="2233.3565"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="153" y="2248.2535">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="216" y="2247.1154">[JWT is valid]</text><polygon fill="#A80036" points="960,2272.7685,970,2276.7685,960,2280.7685,964,2276.7685" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="2276.7685" y2="2276.7685"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="610.5" y="2270.9595">GET user ID by JWT</text><polygon fill="#A80036" points="614.5,2304.4745,604.5,2308.4745,614.5,2312.4745,610.5,2308.4745" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="2308.4745" y2="2308.4745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="620.5" y="2302.6655">user ID</text><polygon fill="#A80036" points="876.5,2336.1805,886.5,2340.1805,876.5,2344.1805,880.5,2340.1805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="2340.1805" y2="2340.1805"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="610.5" y="2334.3715">Get user roles by ID</text><polygon fill="#A80036" points="614.5,2367.8865,604.5,2371.8865,614.5,2375.8865,610.5,2371.8865" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="887.5" y1="2371.8865" y2="2371.8865"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="620.5" y="2366.0775">User roles</text><path d="M148,2386.8865 L211,2386.8865 L211,2395.8865 L201,2405.8865 L148,2405.8865 L148,2386.8865 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="227.1999" style="stroke: #000000; stroke-width: 2.0;" width="692.5" x="148" y="2386.8865"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="163" y="2401.7836">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="226" y="2400.6455">[Authority check requested]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="2430.2986" y2="2430.2986"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="2430.2986" y2="2443.2986"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="2443.2986" y2="2443.2986"/><polygon fill="#A80036" points="614.5,2439.2986,604.5,2443.2986,614.5,2447.2986,610.5,2443.2986" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="610.5" y="2424.4896">Checks if user has required authority</text><path d="M158,2458.2986 L221,2458.2986 L221,2467.2986 L211,2477.2986 L158,2477.2986 L158,2458.2986 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="100.0999" style="stroke: #000000; stroke-width: 2.0;" width="540" x="158" y="2458.2986"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="173" y="2473.1956">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="236" y="2472.0575">[Has authority]</text><polygon fill="#A80036" points="247.5,2497.7106,237.5,2501.7106,247.5,2505.7106,243.5,2501.7106" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="2501.7106" y2="2501.7106"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="253.5" y="2495.9016">Token is valid</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="158" x2="698" y1="2510.7106" y2="2510.7106"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="163" y="2522.4695">[Does not have authority]</text><polygon fill="#A80036" points="247.5,2546.3985,237.5,2550.3985,247.5,2554.3985,243.5,2550.3985" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="2550.3985" y2="2550.3985"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="253.5" y="2544.5895">Unauthorized</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="148" x2="840.5" y1="2566.3985" y2="2566.3985"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="179" x="153" y="2578.1574">[Authority check not requested]</text><polygon fill="#A80036" points="247.5,2602.0864,237.5,2606.0864,247.5,2610.0864,243.5,2606.0864" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="2606.0864" y2="2606.0864"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="253.5" y="2600.2774">Token is valid</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="138" x2="1003.5" y1="2622.0864" y2="2622.0864"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="143" y="2633.8453">[JWT is invalid or expired]</text><polygon fill="#A80036" points="247.5,2657.7743,237.5,2661.7743,247.5,2665.7743,243.5,2661.7743" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="241.5" x2="602.5" y1="2661.7743" y2="2661.7743"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="253.5" y="2655.9653">Token is invalid</text><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1147.5" x="3" y="2698.6273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="2698.6273" y2="2698.6273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1150.5" y1="2701.6273" y2="2701.6273"/><rect fill="#EEEEEE" filter="url(#fanszb5v07vcj)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="299" x="427.25" y="2686.7743"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="282" x="433.25" y="2704.6713">Internal Has Authority Check(Verify Token)</text><polygon fill="#A80036" points="614.5,2742.1864,604.5,2746.1864,614.5,2750.1864,610.5,2746.1864" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="608.5" x2="1061.5" y1="2746.1864" y2="2746.1864"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="620.5" y="2740.3774">POST  /auth/verify-token (JWT, authority)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="2777.8924" y2="2777.8924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="2777.8924" y2="2790.8924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="2790.8924" y2="2790.8924"/><polygon fill="#A80036" points="614.5,2786.8924,604.5,2790.8924,614.5,2794.8924,610.5,2790.8924" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="610.5" y="2772.0834">Validates JWT (internally)</text><path d="M499,2805.8924 L562,2805.8924 L562,2814.8924 L552,2824.8924 L499,2824.8924 L499,2805.8924 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="354.0239" style="stroke: #000000; stroke-width: 2.0;" width="641.5" x="499" y="2805.8924"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="514" y="2820.7894">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="577" y="2819.6513">[JWT is valid]</text><polygon fill="#A80036" points="960,2845.3044,970,2849.3044,960,2853.3044,964,2849.3044" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="966" y1="2849.3044" y2="2849.3044"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="610.5" y="2843.4954">GET user ID by JWT</text><polygon fill="#A80036" points="614.5,2877.0104,604.5,2881.0104,614.5,2885.0104,610.5,2881.0104" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="971" y1="2881.0104" y2="2881.0104"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="620.5" y="2875.2014">user ID</text><polygon fill="#A80036" points="876.5,2908.7164,886.5,2912.7164,876.5,2916.7164,880.5,2912.7164" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="882.5" y1="2912.7164" y2="2912.7164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="610.5" y="2906.9074">Get user roles by ID</text><polygon fill="#A80036" points="614.5,2940.4225,604.5,2944.4225,614.5,2948.4225,610.5,2944.4225" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="608.5" x2="887.5" y1="2944.4225" y2="2944.4225"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="620.5" y="2938.6135">User roles</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="603.5" x2="645.5" y1="2976.1285" y2="2976.1285"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645.5" x2="645.5" y1="2976.1285" y2="2989.1285"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="645.5" y1="2989.1285" y2="2989.1285"/><polygon fill="#A80036" points="614.5,2985.1285,604.5,2989.1285,614.5,2993.1285,610.5,2989.1285" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="610.5" y="2970.3195">Checks if user has required authority</text><path d="M509,3004.1285 L572,3004.1285 L572,3013.1285 L562,3023.1285 L509,3023.1285 L509,3004.1285 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="100.0999" style="stroke: #000000; stroke-width: 2.0;" width="621.5" x="509" y="3004.1285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="524" y="3019.0255">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="587" y="3017.8874">[Has authority]</text><polygon fill="#A80036" points="1050.5,3043.5405,1060.5,3047.5405,1050.5,3051.5405,1054.5,3047.5405" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="603.5" x2="1056.5" y1="3047.5405" y2="3047.5405"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="610.5" y="3041.7315">Token is valid, has authority</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="509" x2="1130.5" y1="3056.5405" y2="3056.5405"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="514" y="3068.2994">[Does not have authority]</text><polygon fill="#A80036" points="1050.5,3092.2284,1060.5,3096.2284,1050.5,3100.2284,1054.5,3096.2284" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="603.5" x2="1056.5" y1="3096.2284" y2="3096.2284"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="610.5" y="3090.4194">Unauthorized</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="499" x2="1140.5" y1="3112.2284" y2="3112.2284"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="504" y="3123.9873">[JWT is invalid or expired]</text><polygon fill="#A80036" points="1050.5,3147.9163,1060.5,3151.9163,1050.5,3155.9163,1054.5,3151.9163" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="603.5" x2="1056.5" y1="3151.9163" y2="3151.9163"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="610.5" y="3146.1073">Token is invalid</text><!--MD5=[ffa801eb4a5ea126d357912e8b12ab27]
@startuml
actor User
participant "Client Application" as Client
participant "Authentication Service" as AuthService
database "User Database" as UserDB
database "Redis" as Redis

box "Internal Interface" #LightBlue
    participant "Other Services" as OtherSvc
end box

== User Registration ==
User -> Client: Initiates Registration
Client -> AuthService: POST /auth/register (user: {name, email, password, roles})
AuthService -> UserDB: Checks if user with email exists
alt User does not exist
    AuthService -> UserDB: Creates new user
    UserDB - -> AuthService: User created (user ID, roles)
    AuthService -> AuthService: Generates JWT (including roles, user ID)
    AuthService - -> Client: Registration Successful (JWT)
    Client <- - User: Registration Successful (JWT)
else User exists
    AuthService - -> Client: Registration Failed (Email already exists)
    Client <- - User: Registration Failed
end

== User Login ==
User -> Client: Initiates Login
Client -> AuthService: POST /auth/login (email, password)
AuthService -> UserDB: Authenticates user
alt Authentication successful
    AuthService -> AuthService: Generates JWT (including roles, user ID)
    AuthService -> Redis: SET JWT (JWT, user ID, TTL)
    Redis - -> AuthService: OK
    AuthService - -> Client: JWT
    Client <- - User: Login Successful (JWT)
else Authentication failed
    AuthService - -> Client: Login Failed (Invalid credentials)
    Client <- - User: Login Failed
end

== User Logout ==
User -> Client: Initiates Logout
Client -> AuthService: POST /auth/logout (JWT)
AuthService -> Redis: DEL JWT
Redis - -> AuthService: (ACK)
AuthService - -> Client: Logout Successful
Client <- - User: Logout Successful

== Get User Profile ==
User -> Client: Requests User Profile
Client -> AuthService: GET /users/me (with JWT)
AuthService -> AuthService: Validates JWT (internally)
alt JWT is valid
    AuthService -> Redis: GET user ID by JWT
    Redis - -> AuthService: user ID
    AuthService -> UserDB: Get user info by ID (user ID from Redis)
    UserDB - -> AuthService: User profile data
    AuthService - -> Client: User profile data
    Client <- - User: User profile displayed
else JWT is invalid or expired
    AuthService - -> Client: Unauthorized
    Client <- - User: Unauthorized
end

== Update User Profile ==
User -> Client: Initiates Profile Update
Client -> AuthService: PUT /users/me (with JWT, updated user data)
AuthService -> AuthService: Validates JWT (internally)
alt JWT is valid
    AuthService -> Redis: GET user ID by JWT
    Redis - -> AuthService: user ID
    AuthService -> UserDB: Updates user profile (user ID, updated data)
    UserDB - -> AuthService: Update successful
    AuthService - -> Client: Update successful
    Client <- - User: Profile updated successfully
else JWT is invalid or expired
    AuthService - -> Client: Unauthorized
    Client <- - User: Unauthorized
end

== Verify Token Endpoint ==
Client -> AuthService: POST /auth/verify-token (JWT, optional authority)
AuthService -> AuthService: Validates JWT (internally)
alt JWT is valid
    AuthService -> Redis: GET user ID by JWT
    Redis - -> AuthService: user ID
    AuthService -> UserDB: Get user roles by ID
    UserDB - -> AuthService: User roles
    alt Authority check requested
        AuthService -> AuthService: Checks if user has required authority
        alt Has authority
            AuthService - -> Client: Token is valid
        else Does not have authority
            AuthService - -> Client: Unauthorized
        end
    else Authority check not requested
        AuthService - -> Client: Token is valid
    end
else JWT is invalid or expired
    AuthService - -> Client: Token is invalid
end


== Internal Has Authority Check(Verify Token) ==
OtherSvc -> AuthService: POST  /auth/verify-token (JWT, authority)
AuthService -> AuthService: Validates JWT (internally)
alt JWT is valid
    AuthService -> Redis: GET user ID by JWT
    Redis - -> AuthService: user ID
    AuthService -> UserDB: Get user roles by ID
    UserDB - -> AuthService: User roles
    AuthService -> AuthService: Checks if user has required authority
    alt Has authority
        AuthService - -> OtherSvc: Token is valid, has authority
    else Does not have authority
        AuthService - -> OtherSvc: Unauthorized
    end
else JWT is invalid or expired
    AuthService - -> OtherSvc: Token is invalid
end
@enduml

PlantUML version 1.2020.02(Sun Mar 01 15:52:07 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.6+7-Ubuntu-124.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>